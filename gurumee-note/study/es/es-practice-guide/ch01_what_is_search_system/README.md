1장 검색 시스템 이해하기
=====================

> 책 "엘라스틱 서치 실무 가이드" 정리한 문서입니다. 책은 저자들의 소중한 자산이기 때문에 책에 나와 있는 모든 내용을 기술하지 않고 최대한 압축해서 정리할 예정입니다. 이 책을 정리하는 이유는 "11번가 하계 인턴" 동안 수행해야 하는 개인 과제 "통합 검색 서비스"를 만들기 위해서 연구 목적입니다. 

Contents
-----------

1. 검색 시스템의 이해
2. 검색 시스템과 엘라스틱서치
3. 실습 환경 구축

검색 시스템의 이해
-----------

### 검색 엔진? 검색 시스템? 검색 서비스?

![검색 엔진, 시스템, 서비스 관계도]()

* 검색 엔진 : 광활한 웹에서 정보를 수집해 검색 결과를 제공하는 프로그램입니다.
* 검색 시스템 : 대용량 데이터를 기반으로 신뢰성 있는 검색 결과를 제공하기 위해 "검색 엔진" 기반으로 구성된 시스템을 뜻합니다.
* 검색 서비스 : 검색 시스템을 활용하여 검색 결과를 제공하는 서비스를 뜻합니다.

### 검색 시스템 구성 요소

![검색 시스템 구성도]()

* 수집기 : 웹사이트, 블로그, 카페 등 웹에서 필요한 모든 정보를 수집하는 프로그램을 말합니다. 흔히 크롤러, 스파이더라고도 합니다.
* 스토리지 : 데이터 저장소를 뜻합니다. 검색 엔진은 색인한 데이터를 이 곳에 보관합니다.
* 색인기 : 수집된 데이터를 검색 가능한 구조로 가공하고 저장하는 역할을 합니다. 보통 다양한 형태소 분석기와 조합해서 사용됩니다.
* 검색기 : 사용자 질의를 입력 받아 색인기에서 저장한 역색인 구조에서 일치하는 문서를 찾아 결과를 반환합니다.

### RDBMS vs ElasticSearch

사실 기존, RDBMS 자체로도 어느 정도 검색 서비스를 만들 수 있습니다. 한 번 기존 RDBMS와 엘라스틱 서치의 구성 단위를 비교해보도록 하겠습니다.

| ES | RDBMS | Description |
| :--: | :--: | :--: |
| Index | Database | 시스템에서 가장 큰 단위 |
| Shard | Partition | Index의 데이터를 저장하여 Indexing된 Document가 실제로 저장되는 곳 |
| Type | Table | 일종의 데이터 구조 |
| Document | Row | 데이터의 한 행 |
| Field | Column | 데이터의 한 행의 열 1개 |
| Mapping | Schema | 필드의 구조와 제약조건에 대한 명시 |
| Query DSL | SQL | 질의 언어 |

데이터 CRUD 방식도 비교해보도록 하겠습니다. ES 는 http 기반 REST API 를 제공합니다. 반면, RDBMS 는 데이터베이스 시스템에서 쿼리를 날려야 하지요.

| CRUD | ES | RDBMS |
| :--: | :--: | :--: |
| 데이터 조회 | GET | SELECT |
| 데이터 생성 | POST | INSERT |
| 데이터 수정 | PUT | UPDATE |
| 데이터 삭제 | DELETE | DELETE |
| 인덱스 정보 확인 | HEAD | - |

> Q. RDBMS도 LIKE 문을 통해 저장된 데이터에서 검색 결과를 추출할 수 있다. 근대 왜 검색 엔진이 나왔을까요?

> A. 그 이유는 일반적인 RDBMS는 전문 검색(Full Text Search) 기능이 지원되지 않기 때문입니다. 동의어, 유의어 처리를 할 수 없기 때문이지요. 이러한 문제 때문에 검색 엔진은 탄생하게 되었습니다. 현재 대부분의 검색 엔진은 형태소 분석기를 포함하고 있기 때문에 RDBMS보다 더 고급진 검색 기능을 지원한답니다.

검색 시스템과 엘라스틱서치
-----------

보통 대량의 데이터를 빠르게 검색하기 위해서 요즘에는 `RDBMS`가 아닌 `NoSQL`을 많이 쓴다. 엘라스틱서치는 `NoSQL`의 일종으로 분산처리를 통해 실시간에 준하는 빠른 검색이 가능합니다. 한 마디로, 엘라스틱서치의 용도는 **대용량 분산 스토리지와 전문 검색이 가능한 검색엔진**이라고 보면 됩니다. 책에서 말하는 엘라스틱의 장단점은 다음과 같습니다.

**장점**

* 오픈소스 검색엔진
* 전문 검색
* 통계 분석
* 스키마리스 - 비정형 데이터를 수집, 통계 분석이 가능합니다.
* RESTful API
* Multi-Tenancy - 상이한 서비스일지라도 필드만 같으면, 여러 개의 인덱스를 한 번에 조회할 수 있습니다.
* 역색인 구조.
* 확장성과 가용성

**단점**

* 정확히 실시간 X - NRT(Near Reartime) 시스템, 즉 실 시간에 준하는 쿼리 능력을 보여줍니다. 큰 단점은 아닙니다.
* 트랜잭션 롤백 제공 X 
* 데이터 업데이트 제공 X - 기존 문서를 싹 삭제하고 다시 데이터를 넣는 방식입니다.

실습 환경 구축
-----------